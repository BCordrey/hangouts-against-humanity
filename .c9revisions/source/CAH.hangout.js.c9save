{"ts":1357850308346,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"function initGoogleAPI()\r\n{\r\n    //setup Google info\r\n    var participantID = gapi.hangout.getParticipantId();\r\n    user = {\"name\": gapi.hangout.getParticipantById(participantID).person.displayName,\r\n            \"id\": gapi.hangout.getParticipantById(participantID).person.id,\r\n            \"imageURL\": gapi.hangout.getParticipantById(participantID).person.image.url,\r\n            \"participantID\": participantID\r\n    };\r\n\r\n    gapi.hangout.data.onStateChanged.add(onStateChanged);\r\n}\r\n\r\n//send event name and string version of JSON object to shared state\r\nfunction sendEvent(eventName, eventData) {\r\n    var id = uniqid();\r\n    if (!eventData) {\r\n        eventData = new Object();\r\n        eventData.sender = user.id;\r\n    }\r\n    gapi.hangout.data.setValue(eventName+\"##\"+id,JSON.stringify(eventData));\r\n}\r\n\r\n\r\n//Process received state change\r\nfunction onStateChanged(event) {\r\n    try {\r\n        Ext.iterate(event.addedKeys, function (obj,index) {\r\n            //event function call\r\n            if (obj.key.search(\"##\")> 0) {\r\n                var eventData = JSON.parse(obj.value);\r\n                var id = obj.key.search(\"##\");\r\n                var funcName = obj.key.substr(0,id);\r\n                eval(funcName + \"(eventData)\");\r\n                gapi.hangout.data.clearValue(obj.key);\r\n            }\r\n        });\r\n\r\n    }\r\n    catch (e) {\r\n\r\n        console.log('Fail state changed');\r\n        console.log(e);\r\n        console.log(event);\r\n    }\r\n}\r\n\r\n"]],"start1":0,"start2":0,"length1":0,"length2":1456}]],"length":1456}
